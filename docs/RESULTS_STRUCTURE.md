# Project1140 æ¶ˆèå®éªŒç»“æœä¿å­˜ç»“æ„

## ğŸ“ ç»“æœä¿å­˜ä½ç½®

æ¶ˆèå®éªŒçš„ç»“æœä¿å­˜åœ¨ä»¥ä¸‹ç›®å½•ç»“æ„ä¸­ï¼š

```
results/
â””â”€â”€ ablation/                          # æ¶ˆèå®éªŒä¸»ç›®å½•
    â”œâ”€â”€ experiment_summary.csv         # æ‰€æœ‰å®éªŒç»“æœæ‘˜è¦
    â”œâ”€â”€ failed_configs.csv            # å¤±è´¥çš„é…ç½®åˆ—è¡¨ï¼ˆå¦‚æœ‰ï¼‰
    â”œâ”€â”€ statistics_report.md          # ç»Ÿè®¡åˆ†ææŠ¥å‘Š
    â”œâ”€â”€ ablation_experiments.log      # å®éªŒè¿è¡Œæ—¥å¿—
    â”‚
    â”œâ”€â”€ LSR_baseline_PV_24h_noTE/     # å•ä¸ªå®éªŒç»“æœç›®å½•
    â”‚   â”œâ”€â”€ config.yaml               # å®éªŒé…ç½®
    â”‚   â”œâ”€â”€ results.xlsx              # è¯¦ç»†ç»“æœï¼ˆExcelæ ¼å¼ï¼‰
    â”‚   â”œâ”€â”€ predictions.csv           # é¢„æµ‹ç»“æœ
    â”‚   â”œâ”€â”€ training_log.csv          # è®­ç»ƒæ—¥å¿—ï¼ˆä»…æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼‰
    â”‚   â””â”€â”€ model.pth                 # è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶
    â”‚
    â”œâ”€â”€ Transformer_high_PV_plus_NWP_72h_TE/
    â”‚   â”œâ”€â”€ config.yaml
    â”‚   â”œâ”€â”€ results.xlsx
    â”‚   â”œâ”€â”€ predictions.csv
    â”‚   â”œâ”€â”€ training_log.csv
    â”‚   â””â”€â”€ model.pth
    â”‚
    â””â”€â”€ [å…¶ä»–358ä¸ªå®éªŒç›®å½•...]
```

## ğŸ“Š ç»“æœæ–‡ä»¶è¯¦ç»†è¯´æ˜

### 1. å®éªŒæ‘˜è¦æ–‡ä»¶ (`experiment_summary.csv`)

åŒ…å«æ‰€æœ‰360ä¸ªå®éªŒçš„æ‘˜è¦ä¿¡æ¯ï¼š

| åˆ—å | æè¿° |
|------|------|
| `config_name` | é…ç½®åç§° |
| `status` | å®éªŒçŠ¶æ€ (completed/failed/timeout/error) |
| `duration` | å®éªŒè€—æ—¶ï¼ˆç§’ï¼‰ |
| `timestamp` | å®éªŒå®Œæˆæ—¶é—´ |
| `mae` | å¹³å‡ç»å¯¹è¯¯å·® |
| `rmse` | å‡æ–¹æ ¹è¯¯å·® |
| `r2` | RÂ²å†³å®šç³»æ•° |
| `mape` | å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·® |

### 2. å¤±è´¥é…ç½®æ–‡ä»¶ (`failed_configs.csv`)

è®°å½•å¤±è´¥çš„å®éªŒé…ç½®ï¼š

| åˆ—å | æè¿° |
|------|------|
| `config_name` | é…ç½®åç§° |
| `status` | å¤±è´¥ç±»å‹ (failed/timeout/error/exception) |
| `error` | é”™è¯¯ä¿¡æ¯ |
| `duration` | è¿è¡Œæ—¶é—´ |

### 3. ç»Ÿè®¡åˆ†ææŠ¥å‘Š (`statistics_report.md`)

åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
- **æ€»ä½“ç»Ÿè®¡**: æˆåŠŸ/å¤±è´¥æ•°é‡ã€æˆåŠŸç‡
- **æ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡**: MAEã€RMSEã€RÂ²ã€MAPEçš„ç»Ÿè®¡ä¿¡æ¯
- **æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ**: æŒ‰æ¨¡å‹ç±»å‹åˆ†ç»„çš„æ€§èƒ½å¯¹æ¯”
- **å¤±è´¥é…ç½®åˆ†æ**: å¤±è´¥ç±»å‹åˆ†å¸ƒ

### 4. å•ä¸ªå®éªŒç»“æœç›®å½•

æ¯ä¸ªå®éªŒéƒ½æœ‰ç‹¬ç«‹çš„ç›®å½•ï¼ŒåŒ…å«ï¼š

#### 4.1 é…ç½®æ–‡ä»¶ (`config.yaml`)
- å®éªŒçš„å®Œæ•´é…ç½®ä¿¡æ¯
- æ¨¡å‹å‚æ•°ã€è®­ç»ƒå‚æ•°ã€æ•°æ®è®¾ç½®ç­‰

#### 4.2 è¯¦ç»†ç»“æœæ–‡ä»¶ (`results.xlsx`)
åŒ…å«25åˆ—çš„è¯¦ç»†å®éªŒç»“æœï¼š

**å®éªŒé…ç½®åˆ— (14åˆ—)**:
- `model`: æ¨¡å‹ç±»å‹
- `use_pv`: æ˜¯å¦ä½¿ç”¨PVè¾“å…¥
- `use_hist_weather`: æ˜¯å¦ä½¿ç”¨å†å²å¤©æ°”
- `use_forecast`: æ˜¯å¦ä½¿ç”¨é¢„æµ‹å¤©æ°”
- `weather_category`: å¤©æ°”ç‰¹å¾ç±»åˆ«
- `use_time_encoding`: æ˜¯å¦ä½¿ç”¨æ—¶é—´ç¼–ç 
- `past_days`: å†å²å¤©æ•°
- `model_complexity`: æ¨¡å‹å¤æ‚åº¦
- `epochs`: è®­ç»ƒè½®æ•°
- `batch_size`: æ‰¹æ¬¡å¤§å°
- `learning_rate`: å­¦ä¹ ç‡

**æ€§èƒ½æŒ‡æ ‡åˆ— (6åˆ—)**:
- `train_time_sec`: è®­ç»ƒæ—¶é—´ï¼ˆç§’ï¼‰
- `inference_time_sec`: æ¨ç†æ—¶é—´ï¼ˆç§’ï¼‰
- `param_count`: å‚æ•°æ•°é‡
- `samples_count`: æµ‹è¯•æ ·æœ¬æ•°é‡
- `best_epoch`: æœ€ä½³è®­ç»ƒè½®æ•°
- `final_lr`: æœ€ç»ˆå­¦ä¹ ç‡

**è¯„ä¼°æŒ‡æ ‡åˆ— (5åˆ—)**:
- `mse`: å‡æ–¹è¯¯å·®
- `rmse`: å‡æ–¹æ ¹è¯¯å·®
- `mae`: å¹³å‡ç»å¯¹è¯¯å·®
- `nrmse`: æ ‡å‡†åŒ–å‡æ–¹æ ¹è¯¯å·®
- `r_square`: RÂ²å†³å®šç³»æ•°
- `smape`: å¯¹ç§°å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®
- `gpu_memory_used`: GPUå†…å­˜ä½¿ç”¨é‡

#### 4.3 é¢„æµ‹ç»“æœæ–‡ä»¶ (`predictions.csv`)
åŒ…å«æ¯ä¸ªé¢„æµ‹ç‚¹çš„è¯¦ç»†ä¿¡æ¯ï¼š

| åˆ—å | æè¿° |
|------|------|
| `window_index` | æ—¶é—´çª—å£ç´¢å¼• |
| `forecast_datetime` | é¢„æµ‹æ—¶é—´ç‚¹ |
| `hour` | å°æ—¶ |
| `y_true` | çœŸå®å€¼ |
| `y_pred` | é¢„æµ‹å€¼ |

#### 4.4 è®­ç»ƒæ—¥å¿—æ–‡ä»¶ (`training_log.csv`)
ä»…æ·±åº¦å­¦ä¹ æ¨¡å‹ç”Ÿæˆï¼ŒåŒ…å«ï¼š

| åˆ—å | æè¿° |
|------|------|
| `epoch` | è®­ç»ƒè½®æ•° |
| `train_loss` | è®­ç»ƒæŸå¤± |
| `val_loss` | éªŒè¯æŸå¤± |
| `learning_rate` | å­¦ä¹ ç‡ |

#### 4.5 æ¨¡å‹æ–‡ä»¶ (`model.pth`)
è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡æ–‡ä»¶ï¼Œå¯ç”¨äºåç»­é¢„æµ‹æˆ–åˆ†æã€‚

## ğŸ” ç»“æœåˆ†æå»ºè®®

### 1. å¿«é€ŸæŸ¥çœ‹æ€»ä½“ç»“æœ
```bash
# æŸ¥çœ‹å®éªŒæ‘˜è¦
cat results/ablation/experiment_summary.csv

# æŸ¥çœ‹ç»Ÿè®¡æŠ¥å‘Š
cat results/ablation/statistics_report.md
```

### 2. åˆ†æç‰¹å®šæ¨¡å‹æ€§èƒ½
```bash
# æŸ¥çœ‹Transformeræ¨¡å‹ç»“æœ
grep "Transformer" results/ablation/experiment_summary.csv
```

### 3. æ¯”è¾ƒä¸åŒè¾“å…¥ç‰¹å¾çš„æ•ˆæœ
```bash
# æ¯”è¾ƒPV vs PV+NWPçš„æ•ˆæœ
grep -E "(PV_24h_noTE|PV_plus_NWP_24h_noTE)" results/ablation/experiment_summary.csv
```

### 4. åˆ†æå¤±è´¥åŸå› 
```bash
# æŸ¥çœ‹å¤±è´¥çš„é…ç½®
cat results/ablation/failed_configs.csv
```

## ğŸ“ˆ ç»“æœå¯è§†åŒ–

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹Pythonä»£ç è¿›è¡Œç»“æœåˆ†æï¼š

```python
import pandas as pd
import matplotlib.pyplot as plt

# åŠ è½½ç»“æœæ‘˜è¦
df = pd.read_csv('results/ablation/experiment_summary.csv')

# æŒ‰æ¨¡å‹ç±»å‹æ¯”è¾ƒæ€§èƒ½
model_performance = df.groupby('model')['mae'].mean().sort_values()
print("æ¨¡å‹æ€§èƒ½æ’åºï¼ˆæŒ‰MAEï¼‰:")
print(model_performance)

# ç»˜åˆ¶æ€§èƒ½åˆ†å¸ƒå›¾
plt.figure(figsize=(12, 6))
df.boxplot(column='mae', by='model', ax=plt.gca())
plt.title('ä¸åŒæ¨¡å‹çš„MAEåˆ†å¸ƒ')
plt.show()
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å­˜å‚¨ç©ºé—´**: 360ä¸ªå®éªŒå¯èƒ½äº§ç”Ÿå¤§é‡æ–‡ä»¶ï¼Œå»ºè®®é¢„ç•™è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´
2. **è¿è¡Œæ—¶é—´**: å®Œæ•´å®éªŒå¯èƒ½éœ€è¦æ•°å°æ—¶åˆ°æ•°å¤©ï¼Œå»ºè®®ä½¿ç”¨å¹¶è¡Œè¿è¡Œ
3. **ç»“æœå¤‡ä»½**: å»ºè®®å®šæœŸå¤‡ä»½é‡è¦çš„å®éªŒç»“æœ
4. **é”™è¯¯å¤„ç†**: å…³æ³¨å¤±è´¥é…ç½®æ–‡ä»¶ï¼ŒåŠæ—¶å¤„ç†å®éªŒé”™è¯¯
